<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025 Fantasy Baseball League Tracker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
        }
        h1, h2 {
            text-align: center;
            color: #333;
        }
        h3 {
            font-size: 16px;
            margin: 10px 0;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
            background-color: white;
            box-shadow: 0 0 5px rgba(0,0,0,0.1);
        }
        th, td {
            padding: 5px;
            text-align: center;
            border: 1px solid #ddd;
            font-size: 12px;
        }
        th {
            background-color: #4CAF50;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        button {
            display: block;
            margin: 20px auto;
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        .league-container {
            display: flex;
            justify-content: space-between;
            gap: 20px;
            margin-top: 20px;
        }
        .league-section {
            flex: 1;
            min-width: 0;
        }
        .division-table {
            margin: 5px 0;
        }
        #alCentralTable {
            margin-bottom: 27px; /* Add spacing to align AL West and NL West headers */
        }
        #standingsTable th {
            padding: 10px;
            font-size: 14px;
            line-height: 1.5;
        }
        #standingsTable td {
            padding: 2px;
            font-size: 12px;
            line-height: 1;
            height: 14px;
            font-weight: bold; /* Make data font bold */
        }
        .expand-btn {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 1px 4px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 10px;
            line-height: 1;
            display: inline-block;
            vertical-align: middle;
        }
        .expand-btn:hover {
            background-color: #45a049;
        }
        .team-details {
            font-size: 10px;
            background-color: #f0f0f0;
        }
        .team-details th, .team-details td {
            padding: 2px;
            line-height: 1;
            height: 14px;
        }
        .team-details th {
            background-color: #e0e0e0;
            color: #333;
        }
        /* News Section Styles */
        .news-section {
            background-color: #1a1a1a;
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
        }
        .news-section h2 {
            color: #4CAF50;
            text-align: left;
            font-size: 24px;
            margin-bottom: 10px;
        }
        .news-section p {
            font-size: 14px;
            line-height: 1.5;
            margin: 5px 0;
        }
        .news-section ul {
            list-style-type: none;
            padding: 0;
        }
        .news-section li {
            font-size: 14px;
            margin: 5px 0;
            padding-left: 20px;
            position: relative;
        }
        .news-section li:before {
            content: "âš¾";
            position: absolute;
            left: 0;
            color: #4CAF50;
        }
        /* League Standings Date */
        .league-date {
            text-align: center;
            font-size: 12px;
            color: #555;
            margin-top: -10px;
            margin-bottom: 10px;
        }
        /* Team Logo Styles */
        .team-logo {
            width: 20px;
            height: 20px;
            vertical-align: middle;
            margin-right: 5px;
        }
        /* Winner Sections */
        .winner-section {
            margin: 20px 0;
            padding: 10px;
            background-color: #e8f5e9;
            border-radius: 5px;
            text-align: center;
        }
        .winner-section h3 {
            margin: 0 0 10px 0;
            color: #2e7d32;
        }
        .winner-section p {
            margin: 0;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>2025 Fantasy Baseball League Tracker</h1>

        <!-- Fantasy League Standings Table -->
        <h2>Fantasy League Standings</h2>
        <table id="standingsTable">
            <thead>
                <tr>
                    <th>Rank</th>
                    <th>Player</th>
                    <th>Wins</th>
                    <th>Losses</th>
                    <th>Win %</th>
                    <th>Games Behind</th>
                    <th>Details</th>
                </tr>
            </thead>
            <tbody id="standingsBody">
            </tbody>
        </table>

        <!-- Winner Sections -->
        <div class="winner-section" id="preAllStarWinner">
            <h3>Pre-All-Star Break Winner</h3>
            <p id="preAllStarWinnerText">Calculating...</p>
        </div>
        <div class="winner-section" id="postAllStarWinner">
            <h3>Post-All-Star Break Winner</h3>
            <p id="postAllStarWinnerText">Calculating...</p>
        </div>

        <!-- AI-Driven News Section -->
        <div class="news-section" id="newsSection">
            <h2>Fantasy League Newsroom: Weekly Update</h2>
            <div id="newsContent"></div>
        </div>

        <button onclick="updateStandings()">Update Standings</button>

        <!-- MLB Team Wins and Losses (Side by Side) -->
        <div class="league-container">
            <!-- American League -->
            <div class="league-section">
                <h2>American League Standings</h2>
                <div class="league-date">(As of April 2, 2025)</div>
                
                <h3>AL East</h3>
                <table class="division-table" id="alEastTable">
                    <thead>
                        <tr>
                            <th>Team</th>
                            <th>W</th>
                            <th>L</th>
                            <th>%</th>
                            <th>GB</th>
                            <th>Home</th>
                            <th>Away</th>
                            <th>L10</th>
                        </tr>
                    </thead>
                    <tbody id="alEastBody">
                        <tr><td><img src="https://www.mlbstatic.com/team-logos/141.svg" class="team-logo">Blue Jays</td><td id="Blue Jays-wins">5</td><td id="Blue Jays-losses">2</td><td id="Blue Jays-winpct"></td><td id="Blue Jays-gb"></td><td id="Blue Jays-home">3-1</td><td id="Blue Jays-away">2-1</td><td id="Blue Jays-l10">5-2</td></tr>
                        <tr><td><img src="https://www.mlbstatic.com/team-logos/139.svg" class="team-logo">Rays</td><td id="Rays-wins">4</td><td id="Rays-losses">3</td><td id="Rays-winpct"></td><td id="Rays-gb"></td><td id="Rays-home">2-1</td><td id="Rays-away">2-2</td><td id="Rays-l10">4-3</td></tr>
                        <tr><td><img src="https://www.mlbstatic.com/team-logos/147.svg" class="team-logo">Yankees</td><td id="Yankees-wins">3</td><td id="Yankees-losses">4</td><td id="Yankees-winpct"></td><td id="Yankees-gb"></td><td id="Yankees-home">2-2</td><td id="Yankees-away">1-2</td><td id="Yankees-l10">3-4</td></tr>
                        <tr><td><img src="https://www.mlbstatic.com/team-logos/110.svg" class="team-logo">Orioles</td><td id="Orioles-wins">3</td><td id="Orioles-losses">4</td><td id="Orioles-winpct"></td><td id="Orioles-gb"></td><td id="Orioles-home">1-2</td><td id="Orioles-away">2-2</td><td id="Orioles-l10">3-4</td></tr>
                        <tr><td><img src="https://www.mlbstatic.com/team-logos/111.svg" class="team-logo">Red Sox</td><td id="Red Sox-wins">2</td><td id="Red Sox-losses">5</td><td id="Red Sox-winpct"></td><td id="Red Sox-gb"></td><td id="Red Sox-home">1-3</td><td id="Red Sox-away">1-2</td><td id="Red Sox-l10">2-5</td></tr>
                    </tbody>
                </table>

                <h3>AL Central</h3>
                <table class="division-table" id="alCentralTable">
                    <thead>
                        <tr>
                            <th>Team</th>
                            <th>W</th>
                            <th>L</th>
                            <th>%</th>
                            <th>GB</th>
                            <th>Home</th>
                            <th>Away</th>
                            <th>L10</th>
                        </tr>
                    </thead>
                    <tbody id="alCentralBody">
                        <tr><td><img src="https://www.mlbstatic.com/team-logos/142.svg" class="team-logo">Twins</td><td id="Twins-wins">2</td><td id="Twins-losses">4</td><td id="Twins-winpct"></td><td id="Twins-gb"></td><td id="Twins-home">1-2</td><td id="Twins-away">1-2</td><td id="Twins-l10">2-4</td></tr>
                        <tr><td><img src="https://www.mlbstatic.com/team-logos/116.svg" class="team-logo">Tigers</td><td id="Tigers-wins">2</td><td id="Tigers-losses">4</td><td id="Tigers-winpct"></td><td id="Tigers-gb"></td><td id="Tigers-home">1-2</td><td id="Tigers-away">1-2</td><td id="Tigers-l10">2-4</td></tr>
                        <tr><td><img src="https://www.mlbstatic.com/team-logos/118.svg" class="team-logo">Royals</td><td id="Royals-wins">2</td><td id="Twins-losses">4</td><td id="Royals-winpct"></td><td id="Royals-gb"></td><td id="Royals-home">1-2</td><td id="Royals-away">1-2</td><td id="Royals-l10">2-4</td></tr>
                        <tr><td><img src="https://www.mlbstatic.com/team-logos/114.svg" class="team-logo">Guardians</td><td id="Guardians-wins">2</td><td id="Guardians-losses">4</td><td id="Guardians-winpct"></td><td id="Guardians-gb"></td><td id="Guardians-home">1-2</td><td id="Guardians-away">1-2</td><td id="Guardians-l10">2-4</td></tr>
                    </tbody>
                </table>

                <h3>AL West</h3>
                <table class="division-table" id="alWestTable">
                    <thead>
                        <tr>
                            <th>Team</th>
                            <th>W</th>
                            <th>L</th>
                            <th>%</th>
                            <th>GB</th>
                            <th>Home</th>
                            <th>Away</th>
                            <th>L10</th>
                        </tr>
                    </thead>
                    <tbody id="alWestBody">
                        <tr><td><img src="https://www.mlbstatic.com/team-logos/140.svg" class="team-logo">Rangers</td><td id="Rangers-wins">4</td><td id="Rangers-losses">3</td><td id="Rangers-winpct"></td><td id="Rangers-gb"></td><td id="Rangers-home">2-1</td><td id="Rangers-away">2-2</td><td id="Rangers-l10">4-3</td></tr>
                        <tr><td><img src="https://www.mlbstatic.com/team-logos/117.svg" class="team-logo">Astros</td><td id="Astros-wins">4</td><td id="Astros-losses">3</td><td id="Astros-winpct"></td><td id="Astros-gb"></td><td id="Astros-home">2-1</td><td id="Astros-away">2-2</td><td id="Astros-l10">4-3</td></tr>
                        <tr><td><img src="https://www.mlbstatic.com/team-logos/136.svg" class="team-logo">Mariners</td><td id="Mariners-wins">2</td><td id="Mariners-losses">5</td><td id="Mariners-winpct"></td><td id="Mariners-gb"></td><td id="Mariners-home">1-3</td><td id="Mariners-away">1-2</td><td id="Mariners-l10">2-5</td></tr>
                        <tr><td><img src="https://www.mlbstatic.com/team-logos/108.svg" class="team-logo">Angels</td><td id="Angels-wins">2</td><td id="Angels-losses">5</td><td id="Angels-winpct"></td><td id="Angels-gb"></td><td id="Angels-home">1-3</td><td id="Angels-away">1-2</td><td id="Angels-l10">2-5</td></tr>
                        <tr><td><img src="https://www.mlbstatic.com/team-logos/133.svg" class="team-logo">A's</td><td id="A's-wins">2</td><td id="A's-losses">6</td><td id="A's-winpct"></td><td id="A's-gb"></td><td id="A's-home">1-3</td><td id="A's-away">1-3</td><td id="A's-l10">2-6</td></tr>
                    </tbody>
                </table>
            </div>

            <!-- National League -->
            <div class="league-section">
                <h2>National League Standings</h2>
                <div class="league-date">(As of April 2, 2025)</div>
                
                <h3>NL East</h3>
                <table class="division-table" id="nlEastTable">
                    <thead>
                        <tr>
                            <th>Team</th>
                            <th>W</th>
                            <th>L</th>
                            <th>%</th>
                            <th>GB</th>
                            <th>Home</th>
                            <th>Away</th>
                            <th>L10</th>
                        </tr>
                    </thead>
                    <tbody id="nlEastBody">
                        <tr><td><img src="https://www.mlbstatic.com/team-logos/143.svg" class="team-logo">Phillies</td><td id="Phillies-wins">4</td><td id="Phillies-losses">3</td><td id="Phillies-winpct"></td><td id="Phillies-gb"></td><td id="Phillies-home">2-1</td><td id="Phillies-away">2-2</td><td id="Phillies-l10">4-3</td></tr>
                        <tr><td><img src="https://www.mlbstatic.com/team-logos/146.svg" class="team-logo">Marlins</td><td id="Marlins-wins">4</td><td id="Marlins-losses">3</td><td id="Marlins-winpct"></td><td id="Marlins-gb"></td><td id="Marlins-home">2-1</td><td id="Marlins-away">2-2</td><td id="Marlins-l10">4-3</td></tr>
                        <tr><td><img src="https://www.mlbstatic.com/team-logos/121.svg" class="team-logo">Mets</td><td id="Mets-wins">3</td><td id="Mets-losses">4</td><td id="Mets-winpct"></td><td id="Mets-gb"></td><td id="Mets-home">2-2</td><td id="Mets-away">1-2</td><td id="Mets-l10">3-4</td></tr>
                        <tr><td><img src="https://www.mlbstatic.com/team-logos/120.svg" class="team-logo">Nationals</td><td id="Nationals-wins">2</td><td id="Nationals-losses">6</td><td id="Nationals-winpct"></td><td id="Nationals-gb"></td><td id="Nationals-home">1-3</td><td id="Nationals-away">1-3</td><td id="Nationals-l10">2-6</td></tr>
                        <tr><td><img src="https://www.mlbstatic.com/team-logos/144.svg" class="team-logo">Braves</td><td id="Braves-wins">0</td><td id="Braves-losses">7</td><td id="Braves-winpct"></td><td id="Braves-gb"></td><td id="Braves-home">0-4</td><td id="Braves-away">0-3</td><td id="Braves-l10">0-7</td></tr>
                    </tbody>
                </table>

                <h3>NL Central</h3>
                <table class="division-table" id="nlCentralTable">
                    <thead>
                        <tr>
                            <th>Team</th>
                            <th>W</th>
                            <th>L</th>
                            <th>%</th>
                            <th>GB</th>
                            <th>Home</th>
                            <th>Away</th>
                            <th>L10</th>
                        </tr>
                    </thead>
                    <tbody id="nlCentralBody">
                        <tr><td><img src="https://www.mlbstatic.com/team-logos/113.svg" class="team-logo">Reds</td><td id="Reds-wins">3</td><td id="Reds-losses">4</td><td id="Reds-winpct"></td><td id="Reds-gb"></td><td id="Reds-home">2-2</td><td id="Reds-away">1-2</td><td id="Reds-l10">3-4</td></tr>
                        <tr><td><img src="https://www.mlbstatic.com/team-logos/138.svg" class="team-logo">Cardinals</td><td id="Cardinals-wins">3</td><td id="Cardinals-losses">4</td><td id="Cardinals-winpct"></td><td id="Cardinals-gb"></td><td id="Cardinals-home">2-2</td><td id="Cardinals-away">1-2</td><td id="Cardinals-l10">3-4</td></tr>
                        <tr><td><img src="https://www.mlbstatic.com/team-logos/134.svg" class="team-logo">Pirates</td><td id="Pirates-wins">3</td><td id="Pirates-losses">4</td><td id="Reds-winpct"></td><td id="Pirates-gb"></td><td id="Pirates-home">2-2</td><td id="Pirates-away">1-2</td><td id="Pirates-l10">3-4</td></tr>
                        <tr><td><img src="https://www.mlbstatic.com/team-logos/158.svg" class="team-logo">Brewers</td><td id="Brewers-wins">3</td><td id="Brewers-losses">4</td><td id="Brewers-winpct"></td><td id="Brewers-gb"></td><td id="Brewers-home">2-2</td><td id="Brewers-away">1-2</td><td id="Brewers-l10">3-4</td></tr>
                        <tr><td><img src="https://www.mlbstatic.com/team-logos/112.svg" class="team-logo">Cubs</td><td id="Cubs-wins">2</td><td id="Cubs-losses">4</td><td id="Cubs-winpct"></td><td id="Cubs-gb"></td><td id="Cubs-home">1-2</td><td id="Cubs-away">1-2</td><td id="Cubs-l10">2-4</td></tr>
                    </tbody>
                </table>

                <h3>NL West</h3>
                <table class="division-table" id="nlWestTable">
                    <thead>
                        <tr>
                            <th>Team</th>
                            <th>W</th>
                            <th>L</th>
                            <th>%</th>
                            <th>GB</th>
                            <th>Home</th>
                            <th>Away</th>
                            <th>L10</th>
                        </tr>
                    </thead>
                    <tbody id="nlWestBody">
                        <tr><td><img src="https://www.mlbstatic.com/team-logos/119.svg" class="team-logo">Dodgers</td><td id="Dodgers-wins">7</td><td id="Dodgers-losses">0</td><td id="Dodgers-winpct"></td><td id="Dodgers-gb"></td><td id="Dodgers-home">4-0</td><td id="Dodgers-away">3-0</td><td id="Dodgers-l10">7-0</td></tr>
                        <tr><td><img src="https://www.mlbstatic.com/team-logos/109.svg" class="team-logo">Diamondbacks</td><td id="Diamondbacks-wins">4</td><td id="Diamondbacks-losses">3</td><td id="Diamondbacks-winpct"></td><td id="Diamondbacks-gb"></td><td id="Diamondbacks-home">2-1</td><td id="Diamondbacks-away">2-2</td><td id="Diamondbacks-l10">4-3</td></tr>
                        <tr><td><img src="https://www.mlbstatic.com/team-logos/135.svg" class="team-logo">Padres</td><td id="Padres-wins">4</td><td id="Padres-losses">3</td><td id="Padres-winpct"></td><td id="Padres-gb"></td><td id="Padres-home">2-1</td><td id="Padres-away">2-2</td><td id="Padres-l10">4-3</td></tr>
                        <tr><td><img src="https://www.mlbstatic.com/team-logos/137.svg" class="team-logo">Giants</td><td id="Giants-wins">3</td><td id="Giants-losses">4</td><td id="Giants-winpct"></td><td id="Giants-gb"></td><td id="Giants-home">2-2</td><td id="Giants-away">1-2</td><td id="Giants-l10">3-4</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        const players = [
            { name: "Kaleb", teams: ["Dodgers", "Twins", "Brewers", "Marlins"] },
            { name: "Clay", teams: ["Braves", "Astros", "Tigers", "Nationals"] },
            { name: "Chris", teams: ["Phillies", "Mariners", "Royals", "A's"] },
            { name: "Pat", teams: ["Rangers", "Cubs", "Blue Jays", "Pirates"] },
            { name: "Tyler", teams: ["Mets", "Padres", "Guardians", "Cardinals"] },
            { name: "Zack", teams: ["Orioles", "Yankees", "Rays", "Angels"] },
            { name: "Terry", teams: ["Red Sox", "Diamondbacks", "Reds", "Giants"] }
        ];

        const divisions = {
            alEast: ["Blue Jays", "Rays", "Yankees", "Orioles", "Red Sox"],
            alCentral: ["Twins", "Tigers", "Royals", "Guardians"],
            alWest: ["Rangers", "Astros", "Mariners", "Angels", "A's"],
            nlEast: ["Phillies", "Marlins", "Mets", "Nationals", "Braves"],
            nlCentral: ["Reds", "Cardinals", "Pirates", "Brewers", "Cubs"],
            nlWest: ["Dodgers", "Diamondbacks", "Padres", "Giants"]
        };

        // Simulated pre-All-Star and post-All-Star break records (as of April 2, 2025)
        const preAllStarRecords = [
            { name: "Kaleb", wins: 16, losses: 11, winPercentage: 0.593 },
            { name: "Clay", wins: 8, losses: 20, winPercentage: 0.286 },
            { name: "Chris", wins: 10, losses: 18, winPercentage: 0.357 },
            { name: "Pat", wins: 14, losses: 13, winPercentage: 0.519 },
            { name: "Tyler", wins: 12, losses: 15, winPercentage: 0.444 },
            { name: "Zack", wins: 12, losses: 16, winPercentage: 0.429 },
            { name: "Terry", wins: 12, losses: 16, winPercentage: 0.429 }
        ];

        const postAllStarRecords = [
            { name: "Kaleb", wins: 0, losses: 0, winPercentage: 0 },
            { name: "Clay", wins: 0, losses: 0, winPercentage: 0 },
            { name: "Chris", wins: 0, losses: 0, winPercentage: 0 },
            { name: "Pat", wins: 0, losses: 0, winPercentage: 0 },
            { name: "Tyler", wins: 0, losses: 0, winPercentage: 0 },
            { name: "Zack", wins: 0, losses: 0, winPercentage: 0 },
            { name: "Terry", wins: 0, losses: 0, winPercentage: 0 }
        ];

        async function fetchPreviousStandings() {
            try {
                const response = await fetch('/previousStandings.json');
                return await response.json();
            } catch (error) {
                console.error('Error fetching previous standings:', error);
                return [
                    { name: "Kaleb", wins: 0, losses: 0, winPercentage: 0 },
                    { name: "Clay", wins: 0, losses: 0, winPercentage: 0 },
                    { name: "Chris", wins: 0, losses: 0, winPercentage: 0 },
                    { name: "Pat", wins: 0, losses: 0, winPercentage: 0 },
                    { name: "Tyler", wins: 0, losses: 0, winPercentage: 0 },
                    { name: "Zack", wins: 0, losses: 0, winPercentage: 0 },
                    { name: "Terry", wins: 0, losses: 0, winPercentage: 0 }
                ];
            }
        }

        async function fetchMLBData() {
            try {
                const response = await fetch('https://statsapi.mlb.com/api/v1/standings?leagueId=103,104&season=2025');
                const data = await response.json();
                const teamData = {};

                data.records.forEach(division => {
                    division.teamRecords.forEach(team => {
                        const teamName = team.team.name;
                        const wins = team.wins;
                        const losses = team.losses;
                        const mappedName = mapTeamName(teamName);
                        if (mappedName) {
                            teamData[mappedName] = { wins, losses };
                        }
                    });
                });

                updateDivisionTables(teamData);
                return teamData;
            } catch (error) {
                console.error('Error fetching MLB data:', error);
                const teamData = {};
                Object.keys(divisions).forEach(division => {
                    divisions[division].forEach(team => {
                        const wins = parseInt(document.getElementById(`${team}-wins`).textContent) || 0;
                        const losses = parseInt(document.getElementById(`${team}-losses`).textContent) || 0;
                        teamData[team] = { wins, losses };
                    });
                });
                updateDivisionTables(teamData);
                return teamData;
            }
        }

        function mapTeamName(apiName) {
            const nameMap = {
                "Los Angeles Dodgers": "Dodgers",
                "Atlanta Braves": "Braves",
                "Philadelphia Phillies": "Phillies",
                "Texas Rangers": "Rangers",
                "New York Mets": "Mets",
                "Baltimore Orioles": "Orioles",
                "Boston Red Sox": "Red Sox",
                "Arizona Diamondbacks": "Diamondbacks",
                "New York Yankees": "Yankees",
                "San Diego Padres": "Padres",
                "Chicago Cubs": "Cubs",
                "Seattle Mariners": "Mariners",
                "Houston Astros": "Astros",
                "Minnesota Twins": "Twins",
                "Milwaukee Brewers": "Brewers",
                "Detroit Tigers": "Tigers",
                "Kansas City Royals": "Royals",
                "Toronto Blue Jays": "Blue Jays",
                "Cleveland Guardians": "Guardians",
                "Tampa Bay Rays": "Rays",
                "Cincinnati Reds": "Reds",
                "San Francisco Giants": "Giants",
                "Los Angeles Angels": "Angels",
                "St. Louis Cardinals": "Cardinals",
                "Pittsburgh Pirates": "Pirates",
                "Oakland Athletics": "A's",
                "Washington Nationals": "Nationals",
                "Miami Marlins": "Marlins"
            };
            return nameMap[apiName] || null;
        }

        function updateDivisionTables(teamData) {
            Object.keys(divisions).forEach(division => {
                const teams = divisions[division].map(team => {
                    const wins = teamData[team]?.wins || 0;
                    const losses = teamData[team]?.losses || 0;
                    const winPct = wins + losses > 0 ? (wins / (wins + losses)).toFixed(3) : "0.000";
                    const homeWins = parseInt(document.getElementById(`${team}-home`).textContent.split('-')[0]) || 0;
                    const homeLosses = parseInt(document.getElementById(`${team}-home`).textContent.split('-')[1]) || 0;
                    const awayWins = parseInt(document.getElementById(`${team}-away`).textContent.split('-')[0]) || 0;
                    const awayLosses = parseInt(document.getElementById(`${team}-away`).textContent.split('-')[1]) || 0;
                    const l10Wins = parseInt(document.getElementById(`${team}-l10`).textContent.split('-')[0]) || 0;
                    const l10Losses = parseInt(document.getElementById(`${team}-l10`).textContent.split('-')[1]) || 0;
                    return { team, wins, losses, winPct, home: `${homeWins}-${homeLosses}`, away: `${awayWins}-${awayLosses}`, l10: `${l10Wins}-${l10Losses}` };
                });

                teams.sort((a, b) => parseFloat(b.winPct) - parseFloat(a.winPct));

                const leaderWins = teams[0].wins;
                const leaderLosses = teams[0].losses;

                const tbody = document.getElementById(`${division}Body`);
                tbody.innerHTML = "";
                teams.forEach(({ team, wins, losses, winPct, home, away, l10 }, index) => {
                    const gamesBehind = index === 0 ? "-" : ((leaderWins - wins) + (losses - leaderLosses)) / 2;
                    const teamLogo = document.querySelector(`#${division}Body tr td img[alt="${team}"]`)?.src || "";
                    const row = document.createElement("tr");
                    row.innerHTML = `
                        <td><img src="${teamLogo}" class="team-logo" alt="${team}">${team}</td>
                        <td id="${team}-wins">${wins}</td>
                        <td id="${team}-losses">${losses}</td>
                        <td id="${team}-winpct">${winPct}</td>
                        <td id="${team}-gb">${gamesBehind === "-" ? "-" : gamesBehind.toFixed(1)}</td>
                        <td id="${team}-home">${home}</td>
                        <td id="${team}-away">${away}</td>
                        <td id="${team}-l10">${l10}</td>
                    `;
                    tbody.appendChild(row);
                });
            });
        }

        function toggleTeamDetails(playerIndex) {
            const detailsRow = document.getElementById(`details-${playerIndex}`);
            const button = document.getElementById(`expand-btn-${playerIndex}`);
            if (detailsRow.style.display === "none") {
                detailsRow.style.display = "";
                button.textContent = "Collapse";
            } else {
                detailsRow.style.display = "none";
                button.textContent = "Expand";
            }
        }

        function generateNews(standings, previousStandings, teamData) {
            let newsContent = "";

            // Current Standings Overview
            newsContent += `<p><strong>Welcome to the Fantasy League Newsroom: Weekly Update!</strong> Kaleb is dominating the standings with a ${standings[0].wins}-${standings[0].losses} record and a ${standings[0].winPercentage} win percentage, leading the pack. Pat is holding strong in second at ${standings[1].wins}-${standings[1].losses}, but the competition is heating up as Tyler, Terry, and Zack are all within striking distance. At the bottom, Clay is struggling at ${standings[standings.length - 1].wins}-${standings[standings.length - 1].losses}â€”can he turn it around?</p>`;

            // Rankings Changes Over the Past Week
            newsContent += "<p><strong>Rankings Shake-Up!</strong> ";
            const rankChanges = standings.map((player, index) => {
                const prevPlayer = previousStandings.find(p => p.name === player.name);
                const prevWins = prevPlayer ? prevPlayer.wins : 0;
                const prevLosses = prevPlayer ? prevPlayer.losses : 0;
                const winsGained = player.wins - prevWins;
                const lossesGained = player.losses - prevLosses;
                return { name: player.name, winsGained, lossesGained, currentRank: index + 1 };
            });

            // Highlight top mover (most wins gained)
            const topMover = rankChanges.reduce((max, player) => player.winsGained > max.winsGained ? player : max, rankChanges[0]);
            newsContent += `Kaleb has surged to the top spot, gaining ${topMover.winsGained} wins this weekâ€”talk about a hot start! `;

            // Highlight second place (Pat)
            const patChange = rankChanges.find(player => player.name === "Pat");
            newsContent += `Pat has also made a big leap, gaining ${patChange.winsGained} wins and ${patChange.lossesGained} losses this week, landing him in second place with a ${standings[1].wins}-${standings[1].losses} record. `;

            // Highlight biggest drop
            const bottomPlayer = rankChanges[standings.length - 1];
            newsContent += `On the flip side, Clay has had a rough week, adding ${bottomPlayer.winsGained} wins but ${bottomPlayer.lossesGained} losses, dropping to the bottom. The Bravesâ€™ 0-7 start isnâ€™t helping his cause!</p>`;

            // Notable Team Contributions
            newsContent += "<p><strong>Spotlight on Hot Teams!</strong> The Dodgers have been unstoppable, going 7-0 this week, which has been a massive boost for Kaleb. Nathan Eovaldiâ€™s complete game shutout against the Reds on Tuesday was a highlight, racking up wins for Kalebâ€™s squad. The Padres, with a 4-3 record, have also been clutch for Tyler, especially with their aggressive play styleâ€”Jackson Merrill is making waves! Meanwhile, the Blue Jaysâ€™ four-game win streak earlier this week helped Pat climb the ranks, but their recent three-game skid against the Mets has slowed his momentum.</p>";

            // Three Quick Facts of the Day/Week
            newsContent += "<p><strong>Three Quick Facts of the Week:</strong></p>";
            newsContent += "<ul>";
            newsContent += "<li>The Dodgers and Padres are the only undefeated teams in the NL as of April 3, giving Kaleb and Tyler a big edge!</li>";
            newsContent += "<li>Tyler Soderstrom of the Aâ€™s has hit 4 home runs this week, but Chris isnâ€™t reaping the benefits with the Aâ€™s at 2-6.</li>";
            newsContent += "<li>Rafael Devers of the Red Sox hit .526 last week, but Terryâ€™s team is still strugglingâ€”can the Red Sox keep the hot streak going?</li>";
            newsContent += "</ul>";

            document.getElementById("newsContent").innerHTML = newsContent;
        }

        function updateWinners() {
            // Pre-All-Star Break Winner
            preAllStarRecords.sort((a, b) => parseFloat(b.winPercentage) - parseFloat(a.winPercentage));
            const preAllStarWinner = preAllStarRecords[0];
            document.getElementById("preAllStarWinnerText").textContent = `${preAllStarWinner.name} leads with a ${preAllStarWinner.wins}-${preAllStarWinner.losses} record (Win %: ${preAllStarWinner.winPercentage})`;

            // Post-All-Star Break Winner
            postAllStarRecords.sort((a, b) => parseFloat(b.winPercentage) - parseFloat(a.winPercentage));
            const postAllStarWinner = postAllStarRecords[0];
            document.getElementById("postAllStarWinnerText").textContent = `${postAllStarWinner.name} leads with a ${postAllStarWinner.wins}-${postAllStarWinner.losses} record (Win %: ${postAllStarWinner.winPercentage})`;
        }

        async function updateStandings() {
            const teamData = await fetchMLBData();
            if (!teamData) return;

            let standings = [];

            players.forEach(player => {
                let totalWins = 0;
                let totalLosses = 0;

                const teamDetails = player.teams.map(team => {
                    const teamStats = teamData[team];
                    const wins = teamStats ? teamStats.wins : 0;
                    const losses = teamStats ? teamStats.losses : 0;
                    totalWins += wins;
                    totalLosses += losses;
                    return { team, wins, losses };
                });

                const winPercentage = totalWins + totalLosses > 0 ? (totalWins / (totalWins + totalLosses)).toFixed(3) : 0;
                standings.push({
                    name: player.name,
                    teamDetails: teamDetails,
                    wins: totalWins,
                    losses: totalLosses,
                    winPercentage: winPercentage
                });
            });

            standings.sort((a, b) => parseFloat(b.winPercentage) - parseFloat(a.winPercentage));

            const leaderWins = standings[0].wins;
            const leaderLosses = standings[0].losses;
            standings.forEach(player => {
                const gamesBehind = ((leaderWins - player.wins) + (player.losses - leaderLosses)) / 2;
                player.gamesBehind = gamesBehind >= 0 ? gamesBehind.toFixed(1) : "-";
            });

            const standingsBody = document.getElementById("standingsBody");
            standingsBody.innerHTML = "";
            standings.forEach((player, index) => {
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${player.name}</td>
                    <td>${player.wins}</td>
                    <td>${player.losses}</td>
                    <td>${player.winPercentage}</td>
                    <td>${player.gamesBehind}</td>
                    <td><button class="expand-btn" id="expand-btn-${index}" onclick="toggleTeamDetails(${index})">Expand</button></td>
                `;
                standingsBody.appendChild(row);

                const detailsRow = document.createElement("tr");
                detailsRow.id = `details-${index}`;
                detailsRow.style.display = "none";
                let detailsContent = '<td colspan="7"><table style="width: 100%; border-collapse: collapse;">';
                detailsContent += `
                    <tr class="team-details">
                        <th style="text-align: left; padding-left: 20px;">Team</th>
                        <th>Wins</th>
                        <th>Losses</th>
                        <th colspan="4"></th>
                    </tr>
                `;
                player.teamDetails.forEach(detail => {
                    detailsContent += `
                        <tr class="team-details">
                            <td style="text-align: left; padding-left: 20px;">${detail.team}</td>
                            <td>${detail.wins}</td>
                            <td>${detail.losses}</td>
                            <td colspan="4"></td>
                        </tr>
                    `;
                });
                detailsContent += '</table></td>';
                detailsRow.innerHTML = detailsContent;
                standingsBody.appendChild(detailsRow);
            });

            // Fetch previous standings from the static file
            const previousStandings = await fetchPreviousStandings();

            // Generate the AI-driven news section
            generateNews(standings, previousStandings, teamData);

            // Update the winners sections
            updateWinners();
        }

        updateStandings();
    </script>
</body>
</html>